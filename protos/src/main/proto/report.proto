syntax = "proto3";

package sec.hdlt.protos.server;

option java_package = "sec.hdlt.protos.server";

service Location {
  rpc LocationReport (ReportRequest) returns (ReportResponse);
  rpc UserLocationReport (UserLocationReportRequest) returns (UserLocationReportResponse);
}

message Coordinates {
  int32 x = 1;
  int32 y = 2;
}

message LocationProof {
  int32 requesterId = 1;
  int32 proverId = 2;
  int32 epoch = 3;
  string signature = 4; // Base64-encoded
}

message ReportRequest {
  int32 id = 1;
  int32 epoch = 2;
  Coordinates location = 3;
  string signature = 4; // Base64-encoded
  repeated LocationProof proofs = 5;
}

message ReportResponse {
  bool ack = 1;
}

message UserLocationReportRequest {
  int32 user = 1;
  int32 epoch = 2;
  string sig = 3;
}

message UserLocationReportResponse {
  int32 user = 1;
  int32 epoch = 2;
  Coordinates location = 3;
}